# Grok CLI Configuration Example
# Copy this to ~/.grok/config.toml (project) or %APPDATA%\grok-cli\config.toml (system)
# and customize as needed.
#
# Priority order (highest → lowest):
#   Environment variables → project .grok/config.toml → system config → built-in defaults

# ── API ──────────────────────────────────────────────────────────────────────
api_key = "xai-your-api-key-here"
default_model = "grok-2-latest"
default_temperature = 0.7
default_max_tokens = 256000

# Request timeout in seconds.
# LLM responses can be slow, especially with large max_tokens or many tool
# calls.  On Starlink the satellite round-trip alone adds ~600 ms, and a
# complex multi-step session can take several minutes.
# ⚠️  30 seconds (old default) is almost always too short — use 300 or higher.
# Environment override: GROK_TIMEOUT
timeout_secs = 300

# How many times to retry a failed request before giving up.
# Each retry uses exponential back-off: 2 s → 4 s → 8 s.
# Environment override: GROK_MAX_RETRIES
max_retries = 3

# ── ACP (Agent Client Protocol / Zed Integration) ────────────────────────────
[acp]
enabled = true
bind_host = "127.0.0.1"
protocol_version = "1.0"
dev_mode = false

# Maximum tool-loop iterations before the agent gives up.
# Prevents runaway loops when the model repeatedly calls tools.
# Recommended values:
#   25  — default, handles most tasks
#   50  — complex multi-step operations
#   100 — very large refactoring / many files
max_tool_loop_iterations = 25

# ── Network (Starlink-optimised) ─────────────────────────────────────────────
[network]
# Enable Starlink-specific retry heuristics (satellite drop detection).
starlink_optimizations = true

# Initial delay before the first retry, in seconds.  Doubles each attempt.
base_retry_delay = 2

# Upper bound on retry delay, in seconds.
max_retry_delay = 60

# Monitor network health and adapt retry behaviour automatically.
health_monitoring = true

# TCP connection timeout in seconds (just for establishing the socket).
# 10 s is usually fine even on Starlink.
# Environment override: GROK_CONNECT_TIMEOUT
connect_timeout = 10

# How long to wait for data after the connection is open, in seconds.
# Set this to match (or slightly exceed) timeout_secs above.
# ⚠️  30 seconds is too short for LLM streaming responses.
# Environment override: GROK_READ_TIMEOUT
read_timeout = 300

# UI Configuration
[ui]
colors = true
progress_bars = true
verbose_errors = false
terminal_width = 80
unicode = true
theme = "default"
hide_tips = false
hide_banner = false
show_model_info_in_chat = true

[ui.footer]
hide_cwd = false
hide_sandbox_status = false
hide_model_info = false

# General Configuration
[general]
preview_features = false
vim_mode = false
disable_auto_update = false
retry_fetch_errors = true

[general.session_retention]
enabled = true
max_age = 86400  # 24 hours in seconds
max_count = 100
min_retention = 10

# Output Configuration
[output]
format = "text"

# Model Configuration
[model]
name = "grok-2-latest"
max_session_turns = 50
summarize_tool_output = true
compression_threshold = 0.8

# Context Configuration
[context]
file_name = "context.md"
import_format = "markdown"
discovery_max_dirs = 10

[context.file_filtering]
respect_git_ignore = true
respect_grok_ignore = true
enable_recursive_file_search = true

# Tools Configuration
[tools]
auto_accept = false
use_ripgrep = true
enable_tool_output_truncation = true
truncate_tool_output_threshold = 1000
enable_hooks = false

[tools.shell]
enable_interactive_shell = false
show_color = true
inactivity_timeout = 300

# Security Configuration
[security]
disable_yolo_mode = false
enable_permanent_tool_approval = false
shell_approval_mode = "prompt"

[security.folder_trust]
enabled = true

[security.environment_variable_redaction]
enabled = true
allowed = []
blocked = []

# Experimental Features
[experimental]
enable_agents = false
extension_management = false

[experimental.extensions]
enabled = false
allow_config_extensions = false

# Logging Configuration
[logging]
level = "info"
file_logging = false
max_file_size_mb = 10
rotation_count = 5

# Telemetry Configuration
[telemetry]
enabled = false

# Rate Limits
[rate_limits]
max_tokens_per_minute = 100000
max_requests_per_minute = 60

# MCP (Model Context Protocol) Servers Configuration
# Configure external MCP servers for extended functionality
# Uncomment and customize the examples below to enable MCP servers

# Example: GitHub MCP Server
# [mcp.servers.github]
# type = "stdio"
# command = "path/to/github_mcp.exe"
# args = []
# env = {}  # Required field - environment variables for the MCP server

# Example: Custom MCP Server with environment variables
# [mcp.servers.custom]
# type = "stdio"
# command = "/usr/local/bin/custom-mcp-server"
# args = ["--verbose", "--config", "/path/to/config"]
# env = { LOG_LEVEL = "debug", API_KEY = "your-key-here" }

# Note: The 'env' field is REQUIRED for each MCP server, even if empty ({})
# This prevents TOML parsing errors during configuration loading
